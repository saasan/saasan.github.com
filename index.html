<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="robots" content="noindex">
    <title>slx.jp</title>
    <link href='//fonts.googleapis.com/css?family=Orbitron:500' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://slx.jp/">
    <link rel="alternate" type="application/rss+xml" title="slx.jp" href="https://slx.jp/feed.xml" />
    <link rel="apple-touch-icon" href="/img/s2works_favicon.png">
    <link rel="me" href="https://misskey.io/@saasan">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@saasan">
    <meta property="og:url" content="https://slx.jp/">
    <meta property="og:title" content="slx.jp">
    <meta property="og:description" content="saasanが作ったソフトウェア、スクリプトを公開するサイト">
    <meta property="og:image" content="https://slx.jp/img/s2works_favicon.png">
    <script type="application/ld+json">
      {
          "@context": "http://schema.org/",
          "@type": "Person",
          "name": "saasan",
          "sameAs": [
              "https://twitter.com/saasan",
              "https://github.com/saasan"
          ]
      }
    </script>
    <script type="application/ld+json">
      {
          "@context": "http://schema.org",
          "@type": "Article",
          "name": "slx.jp",

          "headline": "saasanが作ったソフトウェア、スクリプトを公開するサイト",
          "image": "https://slx.jp/img/s2works_favicon.png",
          "url": "https://slx.jp/",
          "publisher" : {
              "@type": "Person",
              "name": "saasan"
          }
      }
    </script>
  </head>
  <body itemscope itemtype="http://schema.org/WebPage">
    <header class="site-header">
      <div class="wrapper">
        <a class="site-title" href="/">slx.jp</a>
        <nav class="site-nav">
          <div class="site-nav-contents">
            <ul>
              <li><a href="/blog/">ブログ</a></li>
              <li><a href="/imas/">アイマス</a></li>
              <li><a href="/software/">ソフトウェア</a></li>
              <li><a href="/script/">スクリプト</a></li>
            </ul>
          </div>
        </nav>
      </div>
    </header>
    <div class="page-content">
      <div class="wrapper">
        <div class="post" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/WebPageElement">
          <header class="post-header">
            <h1 class="post-title"></h1>
          </header>
          <article class="post-content">
            <section>
              <h2><a class="post-link" href="/blog/2024/12/31/2024%E5%B9%B4%E6%9C%80%E6%96%B0%E7%89%88-%E4%BB%8A%E5%B9%B4%E8%B2%B7%E3%81%A3%E3%81%A6%E3%82%88%E3%81%8B%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE.html">【2024年最新版】今年買ってよかったもの</a></h2>
              <div class="post-meta">2024-12-31</div>
              <section>
                <p>1年以上このサイトを放置してたんで更新方法すら忘れてる感があるが、
                  今年買ってよかったものを羅列していく。</p>
                <h2 id="skagen-jorn-hybrid-hr-スマートウォッチ-skt3000">SKAGEN JORN HYBRID HR スマートウォッチ SKT3000</h2>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B08RDJSZ71?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/81pMxAixRUL._AC_SX679_.jpg" alt="[スカーゲン] 腕時計 JORN 42MM HYBRID HR SKT3000 メンズ ブラウン" />
                    <span class="affiliate-product-name">[スカーゲン] 腕時計 JORN 42MM HYBRID HR SKT3000 メンズ ブラウン</span>
                  </a>
                </div>
                <p>今年一番買ってよかったやつ。
                  アナログ腕時計の文字盤が電子ペーパーになってるタイプのスマートウォッチ。</p>
                <ul>
                  <li>良い点
                    <ul>
                      <li>見た目が普通の腕時計</li>
                      <li>スマホの通知確認、アラームに使えて便利</li>
                      <li>電子ペーパーのためバッテリーが数週間もつ</li>
                    </ul>
                  </li>
                  <li>悪い点
                    <ul>
                      <li>電子ペーパーのため画面の更新は若干もたつく (画面が小さいこともあり1秒もかからないが)</li>
                      <li>タッチパネルではないため、側面にある3つのボタンでの操作が必要
                        <ul>
                          <li>ボタンを押し込む際の荷重は軽めで 3mm ほど出っ張っている</li>
                          <li>手の甲などにあたって画面が勝手に変わっていることがある</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
                <blockquote class="twitter-tweet">
                  <p lang="ja" dir="ltr">先日買ったハイブリッドスマートウォッチのベルト交換してきた <a href="https://t.co/8iD071xftc">pic.twitter.com/8iD071xftc</a></p>
                  &mdash; カガミ (@saasan) <a href="https://twitter.com/saasan/status/1788145173278691625?ref_src=twsrc%5Etfw">May 8, 2024</a></blockquote>
                <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                <h2 id="エレコム-bluetooth50-マウス-ex-g-pro-lサイズ-m-xgl50mbskbk">エレコム Bluetooth5.0 マウス EX-G PRO Lサイズ M-XGL50MBSKBK</h2>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B0CGWN5V9N/?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/71lZi6zwg1L._AC_SX679_.jpg" alt="エレコム ワイヤレスマウス 静音 EX-G PRO Lサイズ Bluetooth 無線2.4GHz 両対応 充電式 8ボタン 高速スクロール チルトホイール 抗菌 ブラック M-XGL50MBSKBK" />
                    <span class="affiliate-product-name">エレコム ワイヤレスマウス 静音 EX-G PRO Lサイズ Bluetooth 無線2.4GHz 両対応 充電式 8ボタン 高速スクロール チルトホイール 抗菌 ブラック M-XGL50MBSKBK</span>
                  </a>
                </div>
                <p>長年使ってた Microsoft Sculpt Ergonomic Mouse が廃番になっていたため乗り換え</p>
                <ul>
                  <li>良い点
                    <ul>
                      <li>高さがあり持ちやすい</li>
                      <li>M、XL サイズも試したが、L サイズの握り心地が一番良かった</li>
                      <li>ボタン数多め</li>
                    </ul>
                  </li>
                  <li>悪い点
                    <ul>
                      <li>充電式のバッテリーは数日しかもたないため、頻繁に充電が必要</li>
                      <li>中クリック(ホイールクリック)がかなり固くて押しづらい</li>
                      <li>充電ケーブルの差込口が狭く、付属の USB Type-C ケーブルでしか充電できない</li>
                    </ul>
                  </li>
                </ul>
                <h2 id="電動空気入れ-panp-ride-mini">電動空気入れ PANP RIDE MINI</h2>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B0D7MMH36N/?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/61csfSJXeKL._AC_SY879_.jpg" alt="PANP RIDE MINI 空気入れ 自転車 ロードバイク ツーリング 日本 メーカー (全バルブ対応) 米式 英式 仏式 バイク ボール 電動空気入れ 自動 軽量 小型コンパクト エアコンプレッサー KUKIIRE スマート空気入れ【保証2年間】" />
                    <span class="affiliate-product-name">PANP RIDE MINI 空気入れ 自転車 ロードバイク ツーリング 日本 メーカー (全バルブ対応) 米式 英式 仏式 バイク ボール 電動空気入れ 自動 軽量 小型コンパクト エアコンプレッサー KUKIIRE スマート空気入れ【保証2年間】</span>
                  </a>
                </div>
                <p>ボタンを押すだけで、事前に設定しておいた空気圧まで自動で空気が入る。便利。</p>
                <h2 id="créer-人感センサーライト">créer 人感センサーライト</h2>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B0B11ZVBQ5/?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/61Pzaizi-nL._AC_SX679_.jpg" alt="créer(クレエ) 人感 センサーライト 室内 【PSE取得済】 明るさ調節(10段階)・点灯時間設定可能/足元灯 コンセント式 省エネ フットライト 電球色 暖色/白色 照明 (ホワイト)" />
                    <span class="affiliate-product-name">créer(クレエ) 人感 センサーライト 室内 【PSE取得済】 明るさ調節(10段階)・点灯時間設定可能/足元灯 コンセント式 省エネ フットライト 電球色 暖色/白色 照明 (ホワイト)</span>
                  </a>
                </div>
                <p>廊下にこれを付けたら、夜中にトイレへ行く際などわざわざ照明をつけなくてもよくなった。
                  コンセント式なので電池交換の手間もない。</p>
                <h2 id="マキタ-携帯電話ホルダー-a-73162">マキタ 携帯電話ホルダー A-73162</h2>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B0BZCXXQPB/?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/81HJjeNtTbL._AC_SX679_.jpg" alt="マキタ(Makita) 携帯電話ホルダー A-73162" />
                    <span class="affiliate-product-name">マキタ(Makita) 携帯電話ホルダー A-73162</span>
                  </a>
                </div>
                <p>Galaxy Z Fold5 がデカいんで、ポケットに入れられないとき使ってる</p>
                <h2 id="secrid-カードケース">Secrid カードケース</h2>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B074MN1146/?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/61Iur4dn5yL._AC_SX679_.jpg" alt="Secrid (シークリッド) - ミニ 財布 本革 RFID保護 カードケース カード最大12枚用, RFID財布。, ブラックオリーブ, 21 mm" />
                    <span class="affiliate-product-name">Secrid (シークリッド) - ミニ 財布 本革 RFID保護 カードケース カード最大12枚用, RFID財布。, ブラックオリーブ, 21 mm</span>
                  </a>
                </div>
                <p>下のレバーを引くとカードが少しずつズレた状態で飛び出すので取り出しやすい</p>
                <h2 id="タニタのツインスティック">タニタのツインスティック</h2>
                <p>バーチャロンやるならやっぱりこれ</p>
                <blockquote class="twitter-tweet">
                  <p lang="ja" dir="ltr">PS4発掘してバーチャロン環境整えた<br />
                    フォースのアーケード一周プレイしてみたけど元々ツインスティック自体に重量があるのと吸盤がガラス天板の机と相性よくて安定感ある <a href="https://t.co/XmwsBOK7wE">pic.twitter.com/XmwsBOK7wE</a></p>
                  &mdash; カガミ (@saasan) <a href="https://twitter.com/saasan/status/1816377426865447364?ref_src=twsrc%5Etfw">July 25, 2024</a></blockquote>
                <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                <h2 id="ロフトベッド">ロフトベッド</h2>
                <p>物を置けるスペースが拡大したが、既に埋まってしまった</p>
                <blockquote class="twitter-tweet">
                  <p lang="ja" dir="ltr">ロフトベッドとポケットコイルマットレスの設置終わった<br />
                    4時間くらいかかった<br />
                    これで起きたときに身体が痛いの改善するといいんだけど <a href="https://t.co/oaUfnpqpv0">pic.twitter.com/oaUfnpqpv0</a></p>
                  &mdash; カガミ (@saasan) <a href="https://twitter.com/saasan/status/1753680538991579183?ref_src=twsrc%5Etfw">February 3, 2024</a></blockquote>
                <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                <h2 id="にゃんぷっぷーぬいぐるみ">にゃんぷっぷーぬいぐるみ</h2>
                <p>かわいい</p>
                <blockquote class="twitter-tweet">
                  <p lang="ja" dir="ltr">にゃんぷっぷーぬいぐるみ届いた！ <a href="https://t.co/nGSoA3g5kp">pic.twitter.com/nGSoA3g5kp</a></p>
                  &mdash; カガミ (@saasan) <a href="https://twitter.com/saasan/status/1853768089244250293?ref_src=twsrc%5Etfw">November 5, 2024</a></blockquote>
                <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
              </section>
            </section>
            <section>
              <h2><a class="post-link" href="/blog/2023/08/14/aptx-adaptive-ll%E5%AF%BE%E5%BF%9Cbluetooth%E6%A9%9F%E5%99%A8%E3%81%A7pc%E3%82%B2%E3%83%BC%E3%83%A0%E3%81%AB%E4%BD%BF%E3%81%88%E3%82%8B%E5%AE%8C%E5%85%A8%E3%83%AF%E3%82%A4%E3%83%A4%E3%83%AC%E3%82%B9%E3%81%AA%E3%82%AA%E3%83%BC%E3%83%87%E3%82%A3%E3%82%AA%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89.html">aptX Adaptive LL 対応 Bluetooth 機器で PC ゲームに使える完全ワイヤレスなオーディオ環境構築</a></h2>
              <div class="post-meta">2023-08-14</div>
              <section>
                <p>PC でゲームをしたり音楽を聞いたりする際に有線のイヤホンを使用していたが、
                  ケーブルが煩わしく感じていたのでゲームに使える完全ワイヤレスイヤホンを探すことにした。</p>
                <h2 id="aptx-ll-と-aptx-adaptive">aptX LL と aptX Adaptive</h2>
                <p>ある程度汎用的に使える Bluetooth 接続のものにしたいが、
                  Bluetooth のプロファイル A2DP で標準のコーデック SBC は音声の遅延が大きい。
                  ゲームに向いた低遅延のコーデックについて調べたところ、
                  aptX LL (Low Latency) と aptX Adaptive という規格があるらしい。</p>
                <p>aptX LL は名前通り低遅延なコーデック、
                  aptX Adaptive はローレイテンシー (LL) モードとハイクオリティ (HQ) モードを切替可能。
                  aptX Adaptive の方が新しいコーデックだが、
                  aptX Adaptive のローレイテンシーモードよりも aptX LL の方が規格上の遅延は少ない。</p>
                <p>よって、aptX LL 対応の機器を買おうとネット上で調べたり某家電量販店で探したが、
                  aptX LL 対応の機器が少なくいいものが見つからなかった。</p>
                <h2 id="creative-bt-w5-と-earfun-air-pro-3-を購入">Creative BT-W5 と EarFun Air Pro 3 を購入</h2>
                <p>結局 aptX Adaptive 対応の USB アダプタ
                  <a href="https://jp.creative.com/p/accessories/creative-bt-w5">Creative BT-W5</a> と
                  完全ワイヤレスイヤホン EarFun Air Pro 3 を購入した。</p>
                <div class="affiliate-product-list">
                  <a href="https://www.amazon.co.jp/dp/B0B1J2WTB2?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/41V33CRpvGL._AC_SY355_.jpg" alt="Creative BT-W4 Bluetooth トランスミッター USB オーディオ/チャット用アナログマイク付 aptX Adaptiveモデル HP-BTW4" />
                    <span class="affiliate-product-name">Creative BT-W4 Bluetooth トランスミッター USB オーディオ/チャット用アナログマイク付 aptX Adaptiveモデル HP-BTW4</span>
                  </a>
                  <a href="https://www.amazon.co.jp/dp/B0BNQ611R2?tag=saasan-22" class="affiliate-product">
                    <img src="https://m.media-amazon.com/images/I/51mtle79kTL._AC_SX522_.jpg" alt="【VGP金賞】EarFun Air Pro 3 ANC搭載完全ワイヤレスイヤホン【Bluetooth 5.3 + 43dBまでノイズキャンセリング】QCC3071チップ搭載/aptX adaptive対応/超低遅延55ms/マルチポイント接続/専用アプリ/cVc8.0通話ノイズリダクション/最大45時間再生/ワイヤレス充電/IPX5防水(ブラック)" />
                    <span class="affiliate-product-name">【VGP金賞】EarFun Air Pro 3 ANC搭載完全ワイヤレスイヤホン【Bluetooth 5.3 + 43dBまでノイズキャンセリング】QCC3071チップ搭載/aptX adaptive対応/超低遅延55ms/マルチポイント接続/専用アプリ/cVc8.0通話ノイズリダクション/最大45時間再生/ワイヤレス充電/IPX5防水(ブラック)</span>
                  </a>
                </div>
                <p>BT-W5 は発売時の記事が印象に残っていたのと、
                  Sound Blaster 等 PC 用サウンド系パーツの老舗メーカーという安心感から選択。</p>
                <p>クリエイティブストアのみでの販売なので、上のリンクは旧機種の BT-W4 にしている。
                  BT-W5 との違いは aptX HD、24bit/96kHz への対応の有無なので低遅延が目的ならどちらでもいい。</p>
                <p>EarFun Air Pro 3 を選んだ理由は、1万円以下の完全ワイヤレスイヤホンで評判が良かったため。</p>
                <p><a href="https://av.watch.impress.co.jp/docs/topic/special/1500373.html">迫力サウンドと強力NCで8,990円! 信じられない超コスパTWS「EarFun Air Pro 3」 - AV Watch[Sponsored]</a></p>
                <h2 id="遅延時間の確認">遅延時間の確認</h2>
                <p>遅延時間の確認には
                  <a href="https://nullvoxpopuli.github.io/latency-tester/">Latency Tester</a>
                  を使用した。
                  Web サイト上で音に合わせてマウスをクリックするかスペースキーを押すことで簡易的に遅延時間を確認できる。</p>
                <p>また、確認に使用した機器は以下の通り。</p>
                <h3 id="アダプタ">アダプタ</h3>
                <table class="border">
                  <thead>
                    <tr>
                      <th>アダプタ</th>
                      <th>対応コーデック</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>サンワサプライ MM-BTUD43</td>
                      <td>SBC, aptX</td>
                    </tr>
                    <tr>
                      <td>Creative BT-W5</td>
                      <td>SBC, aptX, aptX HD, aptX Adaptive</td>
                    </tr>
                  </tbody>
                </table>
                <h3 id="ヘッドホン--イヤホン">ヘッドホン / イヤホン</h3>
                <table class="border">
                  <thead>
                    <tr>
                      <th>ヘッドホン / イヤホン</th>
                      <th>対応コーデック</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>EarFun Air Pro 3</td>
                      <td>SBC, AAC, aptX Adaptive</td>
                    </tr>
                    <tr>
                      <td>Sony MDR-ZX770BN</td>
                      <td>SBC, AAC, aptX</td>
                    </tr>
                    <tr>
                      <td>FOSTEX TM2C</td>
                      <td>SBC, AAC, aptX</td>
                    </tr>
                  </tbody>
                </table>
                <h3 id="確認結果">確認結果</h3>
                <table class="border">
                  <thead>
                    <tr>
                      <th>アダプタ</th>
                      <th>ヘッドホン / イヤホン</th>
                      <th>コーデック</th>
                      <th>遅延時間</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Creative BT-W5</td>
                      <td>EarFun Air Pro 3</td>
                      <td>aptX Adaptive LL</td>
                      <td>100 ms</td>
                    </tr>
                    <tr>
                      <td>サンワサプライ MM-BTUD43</td>
                      <td>Sony MDR-ZX770BN</td>
                      <td>aptX</td>
                      <td>160 ms</td>
                    </tr>
                    <tr>
                      <td>Creative BT-W5</td>
                      <td>Sony MDR-ZX770BN</td>
                      <td>SBC</td>
                      <td>200 ms</td>
                    </tr>
                    <tr>
                      <td>Creative BT-W5</td>
                      <td>FOSTEX TM2C</td>
                      <td>aptX</td>
                      <td>335 ms</td>
                    </tr>
                    <tr>
                      <td>Creative BT-W5</td>
                      <td>EarFun Air Pro 3</td>
                      <td>aptX Adaptive HQ</td>
                      <td>350 ms</td>
                    </tr>
                  </tbody>
                </table>
                <p>当然だが Creative BT-W5 と EarFun Air Pro 3
                  の組み合わせが最も遅延が少ない結果となった。</p>
                <p>実際に PSO2 を遊んでみたがアクションゲームで使用するなら特に問題なさそうだった。
                  音ゲーはやってないからわからない。</p>
                <h2 id="問題点">問題点</h2>
                <p>低遅延という点では満足な結果だったが、
                  それ以外の点でいくつか問題があったので書いておく。</p>
                <h3 id="creative-bt-w5">Creative BT-W5</h3>
                <ul>
                  <li>PC からはスピーカーとして認識される</li>
                  <li>よって Windows 標準の Bluetooth 設定画面からは機器との接続/切断ができず、 Creative 独自のアプリで操作する必要がある</li>
                  <li>Windows 標準の Bluetooth 接続だと機器が切断されたら自動で別のスピーカー等へ音声出力が切り替わるが、それも行われないため手動で切り替えが必要</li>
                  <li>音量が大きいため Windows の音量設定を 1 ～ 5% あたりまで下げる必要があり細かい音量調整が効かない</li>
                </ul>
                <h3 id="earfun-air-pro-3">EarFun Air Pro 3</h3>
                <ul>
                  <li>付属のイヤーピースが最大のものでも私には小さくはずれやすい</li>
                  <li>タッチ操作のため誤タッチにより意図しない操作が発生する場合がある</li>
                </ul>
                <h2 id="参考サイト">参考サイト</h2>
                <ul>
                  <li><a href="https://uzuky.hatenablog.com/entry/20201215/1608005651">aptX LL / Adaptive でやる音ゲー - う！</a></li>
                  <li><a href="https://androplus.org/entry/creative-bt-w5-review/">Creative BT-W5レビュー。aptX Adaptiveで24bit/96kHzや低遅延にできるトランスミッター - AndroPlus</a></li>
                </ul>
              </section>
            </section>
            <section>
              <h2><a class="post-link" href="/blog/2023/07/05/ifttt%E3%81%AEtwitter%E9%80%A3%E6%90%BA%E3%81%8C%E6%9C%89%E6%96%99%E5%8C%96%E3%81%97%E3%81%9F%E3%81%AE%E3%81%A7python%E3%81%A8github-actions%E3%81%A7rss%E3%82%92%E3%83%84%E3%82%A4%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B.html">IFTTT の Twitter 連携が有料化したので Python と GitHub Actions で RSS をツイートする</a></h2>
              <div class="post-meta">2023-07-05</div>
              <section>
                <p>IFTTT で動かしてた某ゲーム公式サイトの RSS をツイートするやつが
                  Twitter 連携の有料化によって動かなくなったため、
                  GitHub Actions で自作の Python スクリプトを動かして代用することにした。</p>
                <p>コードは以下のリポジトリにある。</p>
                <p><a href="https://github.com/saasan/feed2tweet"><img src="https://github-link-card.s3.ap-northeast-1.amazonaws.com/saasan/feed2tweet.png" width="460px" /></a></p>
                <h2 id="なぜ-github-actions-なのか">なぜ GitHub Actions なのか？</h2>
                <ol>
                  <li>Public リポジトリなら無料で利用可能</li>
                  <li>定期的な実行が可能</li>
                  <li>データの永続化に近いことが可能</li>
                  <li>GitHub Actions の利用経験がなかったため学習用として</li>
                </ol>
                <p>RSS 内のどこまでツイートしたかを判別するためその情報を保存しておきたいが、
                  IFTTT を利用する前に調べた際は
                  無料で利用可能でデータの永続化が可能なサービスが見つからなかった記憶がある。</p>
                <p>今回いくつかの候補の中から GitHub Actions について調べていたところ、
                  <a href="https://mjhd.hatenablog.com/entry/2022/06/04/104711">Github Actionsのcacheをデータの永続化(?)に使う - MJHD</a>
                  を見て cache が永続化に利用できると知り GitHub Actions を利用することとした。</p>
                <h2 id="github-actions-の-cache">Github Actions の cache</h2>
                <p>公式のドキュメント: 
                  <a href="https://docs.github.com/ja/actions/using-workflows/caching-dependencies-to-speed-up-workflows">依存関係をキャッシュしてワークフローのスピードを上げる - GitHub Docs</a></p>
                <p>ファイルをキャッシュとして保存し、次回以降のワークフロー実行時に利用できる。</p>
                <p>本来はビルドに必要なライブラリなど依存関係を保持しておき
                  ワークフローの実行を高速化するためのものだが、
                  データの永続化に利用することも可能。</p>
                <p>ただし、7日間以上アクセスされていないキャッシュは削除される。容量は最大10 GB。</p>
                <h2 id="キャッシュの利用方法">キャッシュの利用方法</h2>
                <p>キャッシュを上書きすることはできないため、
                  保存時は常に新しいキャッシュを作成し、
                  読込時は最新のものを取得する必要がある。</p>
                <p>以下のように key に新しいキーを指定することで新しいキャッシュを作成、
                  restore-keys に接頭辞のみ指定すると最新のものが取得できる。</p>
                <div class="language-plaintext highlighter-rouge">
                  <div class="highlight">
                    <pre class="highlight"><code>- name: actions/cache用keyの生成
  run: echo "CACHE_TIMESTAMP=$(date +%s)" &gt;&gt; "$GITHUB_ENV"

- uses: actions/cache@v3
  id: tweeted
  with:
    path: ./tweeted
    key: tweeted-$
    restore-keys: tweeted-
</code></pre>
                  </div>
                </div>
                <h2 id="古いキャッシュの削除">古いキャッシュの削除</h2>
                <p>前述の通り放置していても古いキャッシュは7日で消えるが、
                  <a href="https://zenn.dev/hankei6km/articles/manage-cache-in-github-actions-2023-01">GitHub Actions の Cache 管理(2023 年 1 月の場合)</a>
                  を参考に、1日経ったキャッシュはワークフロー内で削除することとした。</p>
                <p>GitHub CLI の
                  extension (<a href="https://github.com/actions/gh-actions-cache">gh-actions-cache</a>)
                  を使用している。</p>
                <div class="language-plaintext highlighter-rouge">
                  <div class="highlight">
                    <pre class="highlight"><code>- name: Cleanup cache
  run: |
    gh extension install actions/gh-actions-cache

    # キャッシュがない場合にエラーとなって停止するのを防ぐ
    set +e

    # 作成から1日以上経っているキャッシュを削除
    for KEY in $(gh actions-cache list -R "${REPO}" -B "${BRANCH}" --key $ --order asc --sort created-at | grep -P 'days? ago' | cut -f 1)
    do
        echo "Deleting ${KEY}"
        gh actions-cache delete "${KEY}" -R "${REPO}" -B "${BRANCH}" --confirm
    done
  env:
    GH_TOKEN: $
    REPO: $
    BRANCH: $
</code></pre>
                  </div>
                </div>
                <h2 id="github-actions-での定期実行に関する注意点">GitHub Actions での定期実行に関する注意点</h2>
                <p>以下のように schedule で10分毎に実行する設定としたが、
                  <a href="https://docs.github.com/ja/actions/using-workflows/events-that-trigger-workflows#schedule">公式のドキュメント</a>
                  にも書かれている通り、負荷が高い場合は遅延したりそもそも実行されない場合がある。</p>
                <div class="language-plaintext highlighter-rouge">
                  <div class="highlight">
                    <pre class="highlight"><code>on:
  schedule:
    - cron: '3-59/10 * * * *'
</code></pre>
                  </div>
                </div>
                <p>実際半日で72回ほど動くはずが53回しか動いていなかった。
                  確実に動かしたいものは避けたほうがよい。</p>
              </section>
            </section>
          </article>
        </div>
      </div>
    </div>
    <footer class="site-footer">
      <div class="wrapper">
        <nav>
          <ul>
            <li><a href="/blog/">ブログ</a></li>
            <li><a href="/imas/">アイマス</a></li>
            <li><a href="/software/">ソフトウェア</a></li>
            <li><a href="/script/">スクリプト</a></li>
          </ul>
        </nav>
        <div class="footer-link">
          <a href="https://twitter.com/saasan" target="_blank" class="twitter-username">
            saasan
          </a>
          <a href="/feed.xml" target="_blank" class="rss">RSS</a>
        </div>
      </div>
    </footer>
  </body>
</html>
