!function(a,b){"use strict";return"function"==typeof define&&define.amd?void define("ngStorage",["angular"],function(a){return b(a)}):b(a)}("undefined"==typeof angular?null:angular,function(a){"use strict";function b(b){return function(){var c="ngStorage-";this.namespace=function(a){c=a},this.$get=["$rootScope","$window","$log","$timeout",function(d,e,f,g){function h(a){var b=e[a];if(b&&"localStorage"===a){var c="__"+Math.round(1e7*Math.random());try{localStorage.setItem(c,c),localStorage.removeItem(c)}catch(d){b=!1}}return b}var i,j,k=h(b)||(f.warn("This browser does not support Web Storage!"),{setItem:function(){},getItem:function(){}}),l={$default:function(b){for(var c in b)a.isDefined(l[c])||(l[c]=b[c]);return l},$reset:function(a){for(var b in l)"$"===b[0]||delete l[b];return l.$default(a)}};try{k=e[b],k.length}catch(m){f.warn("This browser does not support Web Storage!"),k={}}for(var n,o=0,p=k.length;p>o;o++)(n=k.key(o))&&c===n.slice(0,c.length)&&(l[n.slice(c.length)]=a.fromJson(k.getItem(n)));return i=a.copy(l),d.$watch(function(){var b;j||(j=g(function(){if(j=null,!a.equals(l,i)){b=a.copy(i),a.forEach(l,function(d,e){a.isDefined(d)&&"$"!==e[0]&&k.setItem(c+e,a.toJson(d)),delete b[e]});for(var d in b)k.removeItem(c+d);i=a.copy(l)}},100,!1))}),"localStorage"===b&&e.addEventListener&&e.addEventListener("storage",function(b){c===b.key.slice(0,c.length)&&(b.newValue?l[b.key.slice(c.length)]=a.fromJson(b.newValue):delete l[b.key.slice(c.length)],i=a.copy(l),d.$apply())}),l}]}}a.module("ngStorage",[]).provider("$localStorage",b("localStorage")).provider("$sessionStorage",b("sessionStorage"))});